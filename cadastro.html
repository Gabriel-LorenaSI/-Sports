<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="telaInicial.css" />
    <link rel="stylesheet" href="cadastro.css" />
    <link rel="shortcut icon" href="img/favicon.png" type="image/x-icon" />
    <title>Cadastro +Sports</title>
  </head>
  <body>
    <header class="headerLogin">
      <nav class="nav-full-bleed">
        <img src="img/logo.png" alt="" class="nav-logo" />
        <div class="nav-links-wrapper grid-layout text-button-2">
          <a href="telaInicial.html">Home</a>
          <a href="#">Eventos</a>
          <a href="#">Peladas</a>
          <a href="login.html">Login</a>
        </div>
        <input
          type="text"
          placeholder="Pesquisar"
          class="nav-search text-label"
        />
      </nav>
    </header>
    <section class="cadastroPrincipal">
      <div class="camposDeCadastro">
        <h3 class="text-h3">Cadastro</h3>

        <label for="nome">
          <h4>Nome Completo</h4>
          <input
            class="fontPlaceholder"
            type="text"
            placeholder="Seu nome completo"
            oninput="aplicarMascara(this, 'nome')"
            onblur="validarNome(this)"
            required
          />
          <span class="msg-erro">Digite um nome válido (mínimo 3 letras).</span>
        </label>

        <label for="cpf">
          <h4>CPF</h4>
          <input
            class="fontPlaceholder"
            type="text"
            placeholder="000.000.000-00"
            oninput="aplicarMascara(this, 'cpf')"
            onblur="validarCPF(this)"
            required
          />
          <span class="msg-erro">O CPF deve conter 11 dígitos.</span>
        </label>

        <label for="emaile">
          <h4>E-mail</h4>
          <input
            class="fontPlaceholder"
            type="email"
            placeholder="seu@email.com"
            onblur="validarEmail(this)"
            required
          />
          <span class="msg-erro">Digite um e-mail válido.</span>
        </label>

        <label for="dob">
          <h4>Data de nascimento</h4>
          <input
            class="fontPlaceholder"
            type="text"
            placeholder="dd/mm/aaaa"
            oninput="aplicarMascara(this, 'data')"
            required
          />
        </label>

        <label for="pw">
          <h4>Senha</h4>
          <input
            class="fontPlaceholder"
            type="password"
            id="senhaInput"
            placeholder="Senha forte"
            onblur="validarSenha(this)"
            required
          />
          <span class="msg-erro" id="erroSenha">
            A senha deve ter: 8 caracteres, 1 maiúscula, 1 minúscula, 1 número e
            1 símbolo.
          </span>
        </label>

        <label for="2pw">
          <h4>Confirmar Senha</h4>
          <input
            class="fontPlaceholder"
            type="password"
            placeholder="Repita a senha"
            onblur="validarConfirmarSenha(this)"
            required
          />
          <span class="msg-erro">As senhas não coincidem.</span>
        </label>

        <a href="#" class="buttonCadastro text-button-2">Cadastrar</a>

        <p class="politica text-label">
          Ao entrar, você está aceitando a nossa
          <a href=""> Política de Privacidade</a> e
          <a href="#">Termos de Uso</a>
        </p>
        <p class="logarConta text-label">
          Já tem conta? <a href="login.html">Entrar com sua conta +Sports</a>
        </p>
      </div>

      <div class="imgCadastro">
        <img src="img/imgCadastro.png" alt="imagemTelaDeLogin" />
      </div>
    </section>
    <script>
      /* --- 1. MÁSCARAS (Formata enquanto digita) --- */
      function aplicarMascara(input, tipo) {
        let v = input.value;

        if (tipo === "cpf") {
          input.setAttribute("maxlength", "14");
          v = v.replace(/\D/g, "");
          v = v.replace(/(\d{3})(\d)/, "$1.$2");
          v = v.replace(/(\d{3})(\d)/, "$1.$2");
          v = v.replace(/(\d{3})(\d{1,2})$/, "$1-$2");
          input.value = v;
        }

        if (tipo === "nome") {
          // Remove números e símbolos
          v = v.replace(/[^a-zA-ZÀ-ÿ\s]/g, "");
          input.value = v;
        }

        if (tipo === "data") {
          input.setAttribute("maxlength", "10");
          v = v.replace(/\D/g, "");
          v = v.replace(/(\d{2})(\d)/, "$1/$2");
          v = v.replace(/(\d{2})(\d)/, "$1/$2");
          input.value = v;
        }
      }

      /* --- 2. VALIDAÇÕES (Verifica ao sair do campo) --- */

      function validarNome(input) {
        let span = input.nextElementSibling;
        if (input.value.length < 3) {
          mostrarErro(input, span);
        } else {
          removerErro(input, span);
        }
      }

      function validarCPF(input) {
        let span = input.nextElementSibling;
        // Verifica tamanho (14 contando pontos e traço)
        if (input.value.length !== 14) {
          mostrarErro(input, span);
        } else {
          removerErro(input, span);
        }
      }

      function validarEmail(input) {
        let span = input.nextElementSibling;
        let regexEmail = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

        if (!regexEmail.test(input.value)) {
          mostrarErro(input, span);
        } else {
          removerErro(input, span);
        }
      }

      // VALIDAÇÃO DE SENHA FORTE
      function validarSenha(input) {
        let span = document.getElementById("erroSenha");
        let v = input.value;

        // Regex explicada:
        // (?=.*[a-z]) -> Pelo menos uma minúscula
        // (?=.*[A-Z]) -> Pelo menos uma maiúscula
        // (?=.*[0-9]) -> Pelo menos um número
        // (?=.*[^a-zA-Z0-9]) -> Pelo menos um símbolo
        // .{8,}       -> Mínimo 8 caracteres
        let regexSenha =
          /^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[^a-zA-Z0-9]).{8,}$/;

        if (!regexSenha.test(v)) {
          mostrarErro(input, span);
        } else {
          removerErro(input, span);
        }
      }

      function validarConfirmarSenha(input) {
        let span = input.nextElementSibling;
        let senhaPrincipal = document.getElementById("senhaInput").value;

        if (input.value !== senhaPrincipal || input.value === "") {
          mostrarErro(input, span);
        } else {
          removerErro(input, span);
        }
      }

      /* --- FUNÇÕES AUXILIARES --- */
      function mostrarErro(input, span) {
        input.classList.add("input-invalido");
        span.style.display = "block";
      }

      function removerErro(input, span) {
        input.classList.remove("input-invalido");
        span.style.display = "none";
      }
    </script>
  </body>
</html>
